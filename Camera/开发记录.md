# 2019年10月4日
### **视觉部分需要实现的功能**
* 获取图片，识别出零件上的条码，并获取每个零件中心的**二维坐标**，将**条码-坐标对**输出给机器人系统；
* 机器人无法实现**俯仰运动**，单目相机无法测得深度，故标定结果提供的是二维坐标；
### **视觉部分整体框架**
1. 机器人运动到**事先试验确定**的位置后，拍摄图像；调用接口：`Cam::GetImage(Mat &img)`;
    * 调用`GetImage()`之前需要确保相机已经打开，调用`Cam::OpenDevice();`打开相机；
    * 由于位置是确定的，直接对原图取ROI，舍弃多余图像部分；
2. 根据**实验确定的值，或者根据图像计算值**，对图像进行二值化，得到的图像为黑色部分为感兴趣区域；
3. 将二值图**膨胀k次，然后腐蚀k+1次**，去掉**小孔区域噪音**，并确保感兴趣区域更大，搜索轮廓；
    * **不可**腐蚀到将条码单独完整提出，否则下一步将冲突；
4. 遍历搜索到的轮廓，根据外接矩形提取ROI，**当且仅当**轮廓中识别到**1个条码**时，将该ROI另外保存；
    * 当有2个轮廓识别到同一条码时产生冲突，应该使用区域更大的轮廓；
5. 将另外保存的ROI更精细地识别轮廓，并考虑更优化的直线拟合边界；
6. 计算识别轮廓的中心，并计算归一化坐标，形成**条码-归一化坐标对**，输出给机器人系统；
7. 机器人系统通过**条码**得知工件高度，读取当前自身高度，并通过**机器人-相机坐标系变换关系**得知相机-物体距离，从而实施抓取；

### 待解决的问题
1. 找到合适的**二值化分割阈值**，或者找到合适的方法计算阈值；
2. 如何确定机器人坐标系与相机坐标系的变换关系；


# 2019年10月6日
> 相机标定结果：
> + 像素焦距：fx = 3551.024, fy = 3550.081
> + 主点：[u0, v0] = [ 2796.942, 1807.466 ]
> + 径向畸变系数：[-0.106537147733084,0.100320609326180,-0.021073642930310]  
